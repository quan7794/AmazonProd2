var inputText="",recorderActive=!1,attrArr=`,withid,withclass,withname,withplaceholder,withtext`,addAttribute=function(e,t,n){t.includes("xpath")&&(t="xpath");try{e.setAttribute(t,n)}catch(e){}},removeAttribute=function(e,t,n){try{t=oldAttribute,e.removeAttribute(t),e.style.outline=""}catch(e){}},oldNodes=[],oldAttribute="",allNodes=[],idChecked="",_document="",pageUrl="",highlightElements=function(e,t,n,a){t.includes("//text()")&&(t=t.replace("//text()","//*[text()")+"]"),_document=_document?_document:document;var d;e="."===t?"xpath":e;try{e.includes("xpath")||"."===t?d=_document.evaluate(t,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null):(e="css",d=_document.querySelectorAll(t))}catch(a){t?chrome.runtime.sendMessage({count:"wrongXpath"}):chrome.runtime.sendMessage({count:"blank"});for(var s=0;s<oldNodes.length;s++)removeAttribute(oldNodes[s],e,n);return oldNodes=[],void(allNodes=[])}var l,u;l=e.includes("xpath")?d.snapshotLength:d.length;for(var s=0;s<oldNodes.length;s++)removeAttribute(oldNodes[s],e,n);oldNodes=[],allNodes=[];for(var s=0;s<l;s++)u=e.includes("xpath")?d.snapshotItem(s):d[s],0!=s||"/"===t||"."===t||"/."===t||"//."===t||"//.."===t||1!=u.nodeType||u.scrollIntoViewIfNeeded(),oldNodes.push(u),oldAttribute=e,1==u.nodeType?(addAttribute(u,e,s+1),allNodes.push(u.outerHTML)):allNodes.push(u.name+"=\""+u.value+"\"");if(chrome.runtime.sendMessage({count:allNodes}),_document!==document){var r=getIframeXpath(_document);chrome.runtime.sendMessage({count:["iframe",r]});var o="[xpath], [css]{outline: 2px dotted #0715f7f7 !important}",c=_document.createElement("style");c.textContent=o,_document.documentElement.appendChild(c),o="[xpath=\"1\"], [css=\"1\"]{outline:2px dotted #ffa500 !important}",c=_document.createElement("style"),c.textContent=o,_document.documentElement.appendChild(c)}else chrome.runtime.sendMessage({count:"notIframe"});var h="websiteUrl-"+document.URL;if(pageUrl=h,n){var m=_document.querySelector("["+e+"=\"1\"]"),p=generateRelXpath(m,a);chrome.runtime.sendMessage({count:["suggestedSelector",p]})}};function getElementsByXPath(e){try{let t=[],n=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0,a=n.snapshotLength;e<a;++e)t.push(n.snapshotItem(e));return t.length}catch(e){console.warn(e,"NOT VALID")}}function calculateElements(e){if(!e.xpath)return!1;let t=getElementsByXPath(e.xpath);return t&&chrome.runtime.sendMessage({type:"elementsCount",id:e.id,elementCount:t}),!1}chrome.runtime.onMessage.addListener(function(e,t,n){if(e&&"calcElements"===e.name&&calculateElements(e.data),e&&e.attrArray&&(attrArr=e.attrArray),e&&e.openRecorder&&(recorderActive=!0,attachEvents()),e&&e.stopRecording&&(recorderActive=!1,deattachEvents(),browser.runtime.sendMessage(chrome.runtime.id,{message:"StopRecording"})),e&&e.closed&&(recorderActive=!1,deattachEvents(),browser.runtime.sendMessage(chrome.runtime.id,{message:"DeattachRecorder"})),"recorderAttr"===e.name&&browser.runtime.sendMessage(chrome.runtime.id,{type:"recorderAttr",data:e.data}),"updateCPAttr"===e.name&&browser.runtime.sendMessage(chrome.runtime.id,{type:"updateCPAttr",data:e.data}),e&&"downloadReport"===e.type&&e.data){var d="",i=window.navigator.userAgent.includes("Windows");e.data.forEach(function(e){d+=i?e.join(","):e.join("\t"),d+="\n"});var s=window.document.createElement("a");s.href=window.URL.createObjectURL(new Blob([d],{type:"data:application/vnd.ms-excel;base64,"})),s.download=i?`${e.fileName}.csv`:`${e.fileName}.xls`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}if(tempXpath="",this.indexes=[],this.matchIndex=[],_document){if((e.xpath||""===e.xpath)&&e.name.includes("highlight-element")&&(e.name=e.xpath[1]?e.xpath[1].charAt(0).includes("/")||e.xpath[1].charAt(0).includes("(")||e.xpath[1].substr(0,2).includes("./")?"xpath":"css":"xpath",highlightElements(e.name,e.xpath[1],e.xpath[2],e.xpath[3])),"xpath"===e.name){var a=_document.querySelector("[xpath=\""+e.index+"\"]");a&&(a.style.cssText="outline:2px dotted red !important",a.scrollIntoViewIfNeeded())}if("xpath-remove"===e.name){var a=_document.querySelector("[xpath=\""+e.index+"\"]");a&&(a.style.outline="")}if("css"===e.name){var a=_document.querySelector("[css=\""+e.index+"\"]");a&&(a.style.cssText="outline:2px dotted red !important",a.scrollIntoViewIfNeeded())}if("css-remove"===e.name){var a=_document.querySelector("[css=\""+e.index+"\"]");a&&(a.style.outline="")}e.xpath=""}});function generateId(e){if(_document=e.ownerDocument,e.id){var t=e.id;t=removeLineBreak(t);var n="//*[@id='"+t+"']",a=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,d=[];return d.push(t),d.push(a),d}}function generateClassName(e){if(_document=e.ownerDocument,e.className){var t=e.className;t=removeLineBreak(t);var n="//*[@class='"+t+"']",a=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,d=[];return d.push(t),d.push(a),d}}function generateName(e){if(_document=e.ownerDocument,e.name){var t=e.name;t=removeLineBreak(t);var n="//*[@name='"+t+"']",a=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,d=[];return d.push(t),d.push(a),d}}function generateTagName(e){_document=e.ownerDocument;var t=e.tagName.toLowerCase(),n=_document.evaluate("//"+t,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,a=[];return a.push(t),a.push(n),a}function generateLinkText(e){if(_document=e.ownerDocument,"a"===e.tagName.toLowerCase()){var t=[].reduce.call(e.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim();if(0!==t.length){var n="//a[text()='"+t+"']";t.includes("'")&&(n="//a[text()=\""+t+"\"]");var a=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,d=[];return d.push(t),d.push(a),d}}}function generatePartialLinkText(e){if(_document=e.ownerDocument,"a"===e.tagName.toLowerCase()){var t=[].reduce.call(e.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim();if(0!==t.length){5<t.length&&(t=t.slice(0,t.length-2).slice(0,20));var n="//a[contains(text(),'"+t+"')]";t.includes("'")&&(n="//a[contains(text(),\""+t+"\")]");var a=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,d=[];return d.push(t),d.push(a),d}}}function formAbsXpath(e){if("html"===e.tagName.toLowerCase())return"/html[1]";if("body"===e.tagName.toLowerCase())return"/html[1]/body[1]";for(var t,n=0,a=e.parentNode.childNodes,d=0;d<a.length;d++){if(t=a[d],t===e){var s=formAbsXpath(e.parentNode)+"/"+e.tagName.toLowerCase()+"["+(n+1)+"]";return s}1===t.nodeType&&t.tagName.toLowerCase()===e.tagName.toLowerCase()&&n++}return s}var absXpath="";function generateAbsXpath(e){var t=e.nodeName.toLowerCase();absXpath=t.includes("#comment")?"This is a comment and selectors can't be generated for comment.":t.includes("<pseudo:")?"This is a pseudo element and selectors can't be generated for pseudo element.":t.includes("style")||t.includes("script")?"This is a "+t+" tag. For "+t+" tag, no need to write xpath. :P":formAbsXpath(e);var n=0;if(absXpath.includes("svg")){for(var a=absXpath.split("svg")[0],d=absXpath.split("svg")[1].split("/"),i="",s=0;s<d.length;s++)i=0==s?"*[local-name()='svg']"+d[s]:i+"/*[name()='"+d[s].split("[")[0]+"']["+d[s].split("[")[1];absXpath=a+i}try{n=_document.evaluate(absXpath,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}catch(e){n=0}var l=[absXpath,n];return l}var tempXpath="",indexes=[],matchIndex=[],containsFlag=!1;function isInsideIframe(e){for(var t=!0,n=e.ownerDocument;t;)try{var a=n.ownerDocument;n=a}catch(e){t=!1}return n!==document}function removeLineBreak(e){return e&&(e=0<e.split("\n")[0].length?e.split("\n")[0]:e.split("\n")[1]),e}var containsText="",equalsText="";function formRelXpath(e,t){var n=attributeChoicesForXpath[0],a=[].reduce.call(t.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim().slice(0,50);a=removeLineBreak(a),a=a.split(/[^\u0000-\u00ff]/).reduce(function(e,t){return e.length>t.length?e:t},"").trim(),a=a.split("/")[0].trim(),attributeChoicesForXpath.includes("withouttext")&&(a="");var d=t.tagName.toLowerCase();if(d.includes("svg")&&(d="*"),a.includes("'")?(a=a.split("  ")[a.split("  ").length-1],containsText="[contains(text(),\""+a+"\")]",equalsText="[text()=\""+a+"\"]"):(a=a.split("  ")[a.split("  ").length-1],containsText="[contains(text(),'"+a+"')]",equalsText="[text()='"+a+"']"),d.includes("html"))return"//html"+tempXpath;var s="",l="",u={};if((!t.getAttribute(n)||"id"===n.toLowerCase())&&""!==t.id&&(attributeChoicesForXpath.includes("withid")||"id"===n.toLowerCase())){var r=t.id;r=removeLineBreak(r),tempXpath="//"+d+"[@id='"+r+"']"+tempXpath;var o=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return tempXpath;if(a&&0===t.getElementsByTagName("*").length){var c="//"+d+containsText,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(0===o){var h="//"+d+equalsText,o=e.evaluate(h,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return h;tempXpath=tempXpath}else{if(1===o)return c;tempXpath=tempXpath}}else tempXpath=tempXpath}else if(0!=t.attributes.length){if(!l)for(var m=0;m<t.attributes.length;m++)s=t.attributes[m].name,l=t.attributes[m].nodeValue,null!=l&&""!=l&&("style"!==s||"style"===n)&&"id"!==s&&"xpath"!==s&&(attributeChoicesForXpath.includes("with"+s)||n==s)&&(u[s]=l);if(n in u?(s=n,l=u[s]):"placeholder"in u?(s="placeholder",l=u[s]):"title"in u?(s="title",l=u[s]):"value"in u?(s="value",l=u[s]):"name"in u?(s="name",l=u[s]):"type"in u?(s="type",l=u[s]):"class"in u?(s="class",l=u[s]):(s=Object.keys(u)[0],l=u[s]),l=removeLineBreak(l),null!=l&&""!=l&&"xpath"!==s){var p="//"+d+tempXpath,g="";l.includes("  ")&&(l=l.split("  ")[l.split("  ").length-1],containsFlag=!0),g=l.includes("'")?" "===l.charAt(0)||" "===l.charAt(l.length-1)||containsFlag?"//"+d+"[contains(@"+s+",\""+l.trim()+"\")]"+tempXpath:"//"+d+"[@"+s+"=\""+l+"\"]"+tempXpath:" "===l.charAt(0)||" "===l.charAt(l.length-1)||containsFlag?"//"+d+"[contains(@"+s+",'"+l.trim()+"')]"+tempXpath:"//"+d+"[@"+s+"='"+l+"']"+tempXpath;var o=e.evaluate(g,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o){if(g.includes("@href")&&!n.includes("href")||g.includes("@src")&&!n.includes("src")&&a){var c="//"+d+containsText,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(0===o){var h="//"+d+equalsText,o=e.evaluate(h,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return h}else if(1===o)return c}return g}if(a){var c="//"+d+containsText,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(0===o){var h="//"+d+equalsText,o=e.evaluate(h,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return h;tempXpath=h}else{if(1===o)return c;if(c=g+containsText,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,0===o){var h=g+equalsText,o=e.evaluate(h,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return h}else{if(1===o)return c;l.includes("/")||a.includes("/")?(l.includes("/")&&(c=p+containsText),a.includes("/")&&(c=c.replace(containsText,"")),tempXpath=c):tempXpath=c}}}else tempXpath=g,l.includes("/")&&(tempXpath="//"+d+p)}else if(a){var c="//"+d+containsText,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(0===o){var h="//"+d+equalsText,o=e.evaluate(h,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return h}else if(1===o)return c;tempXpath=c+tempXpath}else(null==l||""==l||s.includes("xpath"))&&(tempXpath="//"+d+tempXpath)}else if(""==l&&a&&!d.includes("script")){var c="//"+d+containsText+tempXpath,o=e.evaluate(c,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(0===o){tempXpath="//"+d+equalsText+tempXpath;var o=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return tempXpath}else{if(1===o)return c;tempXpath=c}}else tempXpath="//"+d+tempXpath;for(var f,E=0,N=t.parentNode.childNodes,m=0;m<N.length;m++){if(f=N[m],f===t){if(indexes.push(E+1),tempXpath=formRelXpath(e,t.parentNode),!tempXpath.includes("/"))return tempXpath;var o=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o)return tempXpath;tempXpath="/"+tempXpath.replace(/\/\/+/g,"/");for(var D=/\/+/g,O=/[^[\]]+(?=])/g;null!=(match=D.exec(tempXpath));)matchIndex.push(match.index);for(var x=0;x<indexes.length;x++){if(0==x){var y=tempXpath.slice(matchIndex[matchIndex.length-1]);null==(match=O.exec(y))?tempXpath=tempXpath+"["+indexes[x]+"]":(y=y.replace(O,indexes[x]).split("]")[0]+"]",tempXpath=tempXpath.slice(0,matchIndex[matchIndex.length-1])+y)}else{var y=tempXpath.slice(matchIndex[matchIndex.length-(x+1)],matchIndex[matchIndex.length-x]);null==(match=O.exec(y))?tempXpath=tempXpath.slice(0,matchIndex[matchIndex.length-x])+"["+indexes[x]+"]"+tempXpath.slice(matchIndex[matchIndex.length-x]):(y=y.replace(O,indexes[x]),tempXpath=tempXpath.slice(0,matchIndex[matchIndex.length-(x+1)])+y+tempXpath.slice(matchIndex[matchIndex.length-x]))}var o=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===o){for(var _=/([a-zA-Z])([^/]*)/g,T=tempXpath.match(_).length,L=x+1;L<T-1;L++){var y=tempXpath.match(/\/([^\/]+)\/?$/)[1],v=tempXpath.match(_);v.splice(T-L,1,"/");for(var b="",m=0;m<v.length-1;m++)b=v[m]?b+"/"+v[m]:b+"//"+v[m];b=(b+"/"+y).replace(/\/\/+/g,"//"),b=b.replace(/\/\/+/g,"/"),b=b.replace(/\/+/g,"//");var o=e.evaluate(b,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;1===o&&(tempXpath=b)}return tempXpath.replace("//html","")}}}1===f.nodeType&&f.tagName.toLowerCase()===t.tagName.toLowerCase()&&E++}}var attributeChoicesForXpath=[];function generateRelXpath(e,t){attributeChoicesForXpath=t.split(",");var n="",a=[];try{_document=e.ownerDocument}catch{return a.push("0 element matching."),a.push("0"),a}var d=e.nodeName.toLowerCase();if(d.includes("#comment"))n="This is a comment and selectors can't be generated for comment.";else if(d.includes("::"))n="This is a pseudo element and selectors can't be generated for pseudo element.";else if(d.includes("style")||d.includes("script"))n="This is a "+d+" tag. For "+d+" tag, no need to write xpath. :P";else{generateAbsXpath(e);try{n=absXpath.includes("/*[local-name")?formRelXpathForSVG(_document,e):getOptimizedRelXpath(_document,e)}catch(e){n=absXpath}}tempXpath="",absXpath="";try{var i=_document.evaluate(n,_document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}catch(e){i=0}return a.push(n),a.push(i),(n.includes("@id=")||n.includes("contains(@id"))&&isAttributeDynamic(n,"id")&&a.push("id"),(n.includes("@class=")||n.includes("contains(@class"))&&isAttributeDynamic(n,"class")&&a.push("class"),a}function optimizeXpath(e,t){let n=t.split("//"),a=n.length;var d=/[^[\]]+(?=])/g;let i=t.match(d),s=1;for(let n=i.length-1;0<n;n--)if(s++,3<i[n].length){s=s;break}let l=t.split("//"+n[a-s])[1],u=0;try{u=e.evaluate(l,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}catch(e){return t}if(1===u)return l;for(let d,l=a-s;0<l;l--){d=t.replace("//"+n[l],"");try{u=e.evaluate(d,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength,1===u&&(t=d)}catch(e){return t}}return t}function getNodename(e){var t,n="";return e.classList.length&&(n=[e.tagName.toLowerCase()],t=e.className.trim(),t=t.replace(/  +/g," "),n.push(t.split(" ").join(".")),n=n.join(".")),n}function getChildNumber(e){var t,n,a,d,s={},l=e.parentNode;for(d=l.children.length,t=0;t<d;t++)l.children[t].classList.length&&(n=l.children[t].classList[0],s[n]?s[n].push(l.children[t]):s[n]=[l.children[t]]);a=Object.keys(s).length||-1;var u={childIndex:-1,childLen:d};return s[Object.keys(s)[0]]===d?(u.childIndex=Array.prototype.indexOf.call(s[e.classList[0]],e),u.childLen=s[Object.keys(s)[0]].length,u):a&&-1!==a&&a!==d?(u.childIndex=Array.prototype.indexOf.call(l.children,e),u.childLen=s[Object.keys(s)[0]].length,u):-1===a?(u.childIndex=Array.prototype.indexOf.call(l.children,e),u.childLen=d,u):u}function parents(e,t){var n,a;return void 0===t?t=[]:(a=getChildNumber(e),n=getNodename(e),n?(1<=a.childLen&&-1!==a.childIndex&&(n+=":nth-child("+(a.childIndex+1)+")"),t.push(n)):5>t.length&&(n=e.tagName.toLowerCase(),-1!==a.childIndex&&(n+=":nth-child("+(a.childIndex+1)+")"),t.push(n))),"BODY"===e.tagName?t:parents(e.parentNode,t)}function generateCSS(e){var t=[],n=0,a="";e||(a="element is inside iframe & it is not supported by ChroPath currently. Please write CSS manually.",n=0);var d=e.tagName.toLowerCase();if((d.includes("style")||d.includes("script")||d.includes("svg"))&&(a="This is "+d+" tag. For "+d+" tag, no need to write selector. :P",n=0),""!==e.id)a="#"+e.id;else if(d.includes("body")||d.includes("head")||d.includes("html"))a=d;else{var i=parents(e,[]);i=i.reverse();var s=i.slice(i.length-1,i.length),l=i.slice(0,i.length-1),a="";a=0==l.length?s:l.join(" ")+" > "+s}try{var u=_document.querySelectorAll(a);n=u.length}catch(e){n=0}return t.push(a),t.push(n),t}function generateLabel(e){var t=Math.round;_document=e.ownerDocument;var n=_document===document?"":"(inside iframe)",a="",d="",s={},l="",u=e.nodeName.toLowerCase();if(u.includes("path")||"g"==u)for(;!e.nodeName.toLowerCase().includes("svg")&&(e=e.parentElement,u=e.nodeName.toLowerCase(),!u.includes("svg")););if(u.includes("svg")&&(e=e.parentElement),u.includes("pseudo")){var r=e.parentElement.className;return l=r.includes("icon")?r.replace(/-/g,""):getComputedStyle(e,"").getPropertyValue("content"),l.trim()+n}if(["button","input","meter","output","progress","select","textarea"].includes(u)&&e.id)try{return l=_document.querySelector("label[for='"+e.id+"']").textContent,l.trim()+n}catch(e){}else if(u.includes("style")||u.includes("script")||u.includes("body")||u.includes("html")||u.includes("head")||u.includes("link")||u.includes("meta")||u.includes("title")||u.includes("comment"))try{return l=e.className?e.className.split(" ")[0]:e.id?e.id:u+"Tag",l.trim()+n}catch(e){}if(u.includes("label"))l=[].reduce.call(e.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim();else if(0!=e.attributes.length){if(!d)for(var o=0;o<e.attributes.length;o++)a=e.attributes[o].name,d=e.attributes[o].nodeValue,null==d||""==d||a.includes("style")||a.includes("id")||a.includes("xpath")||(s[a]=d);var c=[].reduce.call(e.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim();if(a="",d="","placeholder"in s?(a="placeholder",d=s[a]):c?d=c:"name"in s?(a="name",d=s[a]):"value"in s?(a="value",d=s[a]):"aria-label"in s?(a="aria-label",d=s[a]):"title"in s?(a="title",d=s[a]):"alt"in s?(a="alt",d=s[a]):"for"in s?(a="for",d=s[a]):"data-label"in s?(a="data-label",d=s[a]):"date-fieldlabel"in s?(a="date-fieldlabel",d=s[a]):"data-displaylabel"in s?(a="data-displaylabel",d=s[a]):"role"in s&&(a="role",d=s[a]),l=d,!l){var h=["search","remove","delete","close","cancel","plus","add","subtract","minus","cart","home","logo","notification","globe"],m=e.className.toLowerCase();if(m)for(var o=0;o<h.length;o++)m.includes(h[o])&&(l=h[o]+" icon")}}if(!l||3>l.length){if(l=[].reduce.call(e.childNodes,function(e,t){return e+(3===t.nodeType?t.textContent:"")},"").trim(),l=l?l:e.textContent.trim(),!l){var p=new WebPage(document);try{l=p.getLabel(e)}catch(e){}var g=!1;if(l&&l.text&&l.text.length){var f=l&&l.text&&t(l.text.length/2),E=l.text.slice(0,f);g=E==l.text.slice(f)}g&&(l.text=E,l=l.text),l=l?l.text:""}l=l?l:e.parentElement.textContent.trim()}return l||(e=e.parentElement,l=generateLabel(e)),l=l?l:"",l=l.includes("inside iframe")?l:l+n,l.trim()}function getOptimizedRelXpath(e,t){let n="";try{n=formRelXpath(e,t)}catch(a){tempXpath="",attributeChoicesForXpath=["withoutid","withoutclass"],n=formRelXpath(e,t)}let a=/\/\/+/g,d=0;try{d=n.match(a).length}catch(e){}return 1<d&&n.includes("[")&&!n.includes("@href")&&!n.includes("@src")&&(n=optimizeXpath(e,n)),void 0===n&&(n="It might be pseudo element/comment/inside iframe from different src. XPath doesn't support for them."),n}function formRelXpathForSVG(e,t){var n=attributeChoicesForXpath[0],a=t.tagName.toLowerCase();if(tagFormat=a.includes("svg")?"//*[local-name()='"+a:"//*[name()='"+a,a.includes("svg")){try{var d=tempXpath;tempXpath="",indexes=[],tempXpath=getOptimizedRelXpath(e,t.parentNode)+"//*[local-name()='svg']"+d,indexes=[]}catch(e){}return tempXpath}var s="",l="",u={},r="";try{t.attributes.removeNamedItem("xpath"),r=t.attributes.length}catch(e){r=t.attributes.length}if((!t.getAttribute(n)||"id"===n.toLowerCase())&&""!==t.id&&attributeChoicesForXpath.includes("withid")){var o=t.id;o=removeLineBreak(o),tempXpath=tagFormat+"' and @id='"+o+"']"+tempXpath;var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath}else if(0<r){if(!l)for(var h=0;h<t.attributes.length;h++)s=t.attributes[h].name,l=t.attributes[h].nodeValue,null!=l&&""!=l&&("style"!==s||"style"===n)&&"id"!==s&&"xpath"!==s&&(u[s]=l.trim().slice(0,10));if(0<Object.keys(u).length)if(n in u?(s=n,l=u[s]):"placeholder"in u?(s="placeholder",l=u[s]):"title"in u?(s="title",l=u[s]):"value"in u?(s="value",l=u[s]):"name"in u?(s="name",l=u[s]):"type"in u?(s="type",l=u[s]):"class"in u?(s="class",l=u[s]):(s=Object.keys(u)[0],l=u[s]),l=removeLineBreak(l),null!=l&&""!=l&&"xpath"!==s){l.includes("  ")&&(l=l.split("  ")[l.split("  ").length-1],containsFlag=!0),tempXpath=l.includes("'")?tagFormat+"\" and contains(@"+s+",\""+l+"\")]"+tempXpath:tagFormat+"' and contains(@"+s+",'"+l+"')]"+tempXpath;var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath}else if(null==l||""==l||s.includes("xpath")){tempXpath=tagFormat+"'"+tempXpath;var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath}}else{tempXpath=tagFormat+"']"+tempXpath;var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath}for(var m,p=0,g=t.parentNode.childNodes,h=0;h<g.length;h++){if(m=g[h],m===t){if(indexes.push(p+1),tempXpath=formRelXpathForSVG(e,t.parentNode),!tempXpath.includes("/"))return tempXpath;var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath;for(var f=absXpath.split("/*"),E=tempXpath.split("/*"),N=f.length-1;0<N;N--){tempXpath=tempXpath.replace(E[N],f[N]);var c=e.evaluate(tempXpath,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(1===c)return tempXpath}}1===m.nodeType&&m.tagName.toLowerCase()===t.tagName.toLowerCase()&&p++}}var eventHandlers={};function addListeners(e,t,n,a){n.handlerName=e,a||(a=!1);let d=a?"C_"+t:t;eventHandlers[d]||(eventHandlers[d]=[]),eventHandlers[d].push(n)}function parseEventKey(e){return e.match(/^C_/)?{eventName:e.substring(2),capture:!0}:{eventName:e,capture:!1}}function attachEvents(){if(!this.attached){this.attached=!0,this.eventListeners={};var e=this;for(let d in eventHandlers){function i(){var t=eventHandlers[d],s=function(n){for(var a=0;a<t.length;a++)t[a].call(e,n)};this.window.document.addEventListener(n,s,a),this.eventListeners[d]=s;var l=document.getElementsByTagName("iframe");if(l)for(var u=0;u<l.length;u++)l[u].contentDocument&&l[u].contentDocument.addEventListener(n,s,a)}var t=parseEventKey(d),n=t.eventName,a=t.capture;i.call(this),browser.runtime.sendMessage(chrome.runtime.id,{data:``,message:"AttachRecorder"})}}}function deattachEvents(){if(this.attached){for(let a in this.attached=!1,this.eventListeners){var e=parseEventKey(a),t=e.eventName,n=e.capture;this.window.document.removeEventListener(t,this.eventListeners[a],n)}delete this.eventListeners}}window.onload=function(){browser.runtime.sendMessage(chrome.runtime.id,{type:"verification",data:[]})};function isAlphaNumeric(e){var t=/[a-zA-Z]/,n=/\d/;return!!(t.test(e)&&n.test(e)||n.test(e))}var recorderCommands={addSelection:"select",clickAt:"Click on",doubleClickAt:"Double click on",rightClick:"Right click on",select:"select",sendKeys:"Hit Enter",submit:"Hit Enter",type:"Enter"};function record(e,t,n="",a){if(a)return browser.runtime.sendMessage(chrome.runtime.id,{data:recorderCommands[e],type:"windowEvent",dataText:"",relXpath:""}),!1;var d=generateLabel(t);try{var i=generateRelXpath(t,attrArr)}catch(n){try{var i=generateAbsXpath(t)}catch(t){return!1}}d&&(d=d.slice(0,30),browser.runtime.sendMessage(chrome.runtime.id,{data:`${recorderCommands[e]+" "+d}`,type:"windowEvent",dataText:n,relXpath:i?i[0]:"",planeLabel:d}))}function getIframeXpath(e){for(var t=document.querySelectorAll("iframe"),n=0;n<t.length;n++)if(t[n].contentDocument==e){var a=generateRelXpath(t[n],",withid,withclass,withname,withplaceholder,withtext");return _document=e,a}}function isAttributeDynamic(e,t){var n=new RegExp("@"+t+",'(.*?)'","g"),a=new RegExp("@+"+t+"+='(.*?)'","g"),d=e.match(n),i=e.match(a);return!!isAlphaNumeric(d)||isAlphaNumeric(i)}var typeTarget,typeLock=0,eventCaptured=0,prevTargetElement=null,inputTypes=["text","password","file","datetime","datetime-local","date","month","time","week","number","range","email","url","search","tel","color"];addListeners("type","change",function(e){if(e.target.tagName&&!preventType&&0==typeLock&&(typeLock=1)){prevTargetElement=e.target;var t=e.target.tagName.toLowerCase(),n=e.target.type;if(!("input"==t&&0<=inputTypes.indexOf(n)))"textarea"==t&&record("type",e.target,e.target.value);else if(!(0<e.target.value.length))record("type",e.target,e.target.value);else if(record("type",e.target,e.target.value),eventCaptured=1,null!=enterTarget){for(var a=e.target.parentElement,d=a.tagName.toLowerCase();"form"!=d&&"body"!=d;)a=a.parentElement,d=a.tagName.toLowerCase();"form"==d&&(a.hasAttribute("id")||a.hasAttribute("name"))&&!a.hasAttribute("onsubmit")?record("sendKeys",enterTarget,null,!0):record("sendKeys",enterTarget,null,!0),enterTarget=null}}typeLock=0}),addListeners("type","input",function(e){typeTarget=e.target});var preventClickTwice=!1,clickCounter=0;addListeners("clickAt","click",function(e){if(eventCaptured=0,clickCounter++,0==e.button&&!preventClick&&e.isTrusted){if(!preventClickTwice&&1===clickCounter){var t=e.pageY,n=e.pageX,a=e.target;do t-=a.offsetTop,n-=a.offsetLeft,a=a.offsetParent;while(a);for(var d=e.target,s=d.getAttribute("type"),l=d.parentNode.tagName,u=0;3>u;u++)try{var r=d.parentNode;"FORM"==r.tagName&&(l=r.tagName)}catch(e){}"INPUT"!=d.nodeName&&("SELECT"!=d.nodeName||"text"!=s&&"email"!=s&&"password"!=s&&"tel"!=s&&"number"!=s&&("FORM"!=l||s)||"radio"==s||"checkbox"==s)&&"FORM"!=d.nodeName&&"BODY"!=d.nodeName&&(prevTargetElement=e.target,record("clickAt",e.target)),preventClickTwice=!0}setTimeout(function(){preventClickTwice=!1,clickCounter=0},200)}},!0),addListeners("doubleClickAt","dblclick",function(e){clickCounter=0;var t=e.target;"FORM"==t.tagName||"BODY"==t.tagName||record("doubleClickAt",e.target)},!0);for(var focusTarget=null,focusValue=null,tempValue=null,preventType=!1,inp=document.getElementsByTagName("input"),i=0;i<inp.length;i++)0<=inputTypes.indexOf(inp[i].type)&&(inp[i].addEventListener("focus",function(e){focusTarget=e.target,focusValue=focusTarget.value,tempValue=focusValue,preventType=!1}),inp[i].addEventListener("blur",function(e){focusTarget=null,focusValue=null,tempValue=null}));var preventClick=!1,enterTarget=null,varenterValue=null,tabCheck=null;addListeners("sendKeys","keydown",function(e){if(e.target.tagName){var t=e.keyCode,n=e.target.tagName.toLowerCase(),a=e.target.type;if("input"==n&&0<=inputTypes.indexOf(a)){if(prevTargetElement=e.target,13==t){enterTarget=e.target,enterValue=enterTarget.value;var d=e.target.parentElement,i=d.tagName.toLowerCase();if(tempValue==enterTarget.value&&tabCheck==enterTarget)record("sendKeys",enterTarget,null,!0),enterTarget=null,preventType=!0;else if(focusValue==enterTarget.value){for(;"form"!=i&&"body"!=i;)d=d.parentElement,i=d.tagName.toLowerCase();"form"==i&&(d.hasAttribute("id")||d.hasAttribute("name"))&&!d.hasAttribute("onsubmit")?d.hasAttribute("id")?record("submit","id="+d.id,"",!0):d.hasAttribute("name")&&record("submit","name="+d.name,"",!0):record("sendKeys",enterTarget,null,!0),enterTarget=null}if(typeTarget.tagName&&!preventType&&(typeLock=1)){var n=typeTarget.tagName.toLowerCase(),a=typeTarget.type;if(!("input"==n&&0<=inputTypes.indexOf(a)))"textarea"==n&&record("type",typeTarget,typeTarget.value);else if(!(0<typeTarget.value.length))record("type",typeTarget,typeTarget.value);else if(record("type",typeTarget,typeTarget.value),null!=enterTarget){for(var d=typeTarget.parentElement,i=d.tagName.toLowerCase();"form"!=i&&"body"!=i;)d=d.parentElement,i=d.tagName.toLowerCase();"form"==i&&(d.hasAttribute("id")||d.hasAttribute("name"))&&!d.hasAttribute("onsubmit")?d.hasAttribute("id")?record("submit",[["id="+d.id,"id"]],"",!0):d.hasAttribute("name")&&record("submit",[["name="+d.name,"name"]],"",!0):record("sendKeys",enterTarget,null,!0),enterTarget=null}}preventClick=!0,setTimeout(function(){preventClick=!1},500),setTimeout(function(){enterValue!=e.target.value&&(enterTarget=null)},50)}var s=!1;(38==t||40==t)&&""!=e.target.value&&(null!=focusTarget&&focusTarget.value!=tempValue&&(s=!0,tempValue=focusTarget.value),s&&record("type",e.target,tempValue),setTimeout(function(){tempValue=focusTarget.value},250),38==t?record("sendKeys",e.target,"",!0):record("sendKeys",e.target,"",!0),tabCheck=e.target),9==t&&tabCheck==e.target&&(record("sendKeys",e.target,"",!0),preventType=!0)}}},!0),addListeners("contextMenu","contextmenu",function(e){var t=e.target;"FORM"==t.tagName||"BODY"==t.tagName||record("rightClick",e.target)},!0);var checkFocus=0;addListeners("editContent","focus",function(e){var t=e.target.contentEditable;"true"==t&&(getEle=e.target,contentTest=getEle.innerHTML,checkFocus=1)},!0),browser.runtime.sendMessage({attachRecorderRequest:!0}).catch(function(e){});function getOptionLocator(e){var t=e.text.replace(/^ *(.*?) *$/,"$1");return t.match(/\xA0/)?"label=regexp:"+t.replace(/[\(\)\[\]\\\^\$\*\+\?\.\|\{\}]/g,function(e){return"\\"+e}).replace(/\s+/g,function(e){return e.match(/\xA0/)?1<e.length?"\\s+":"\\s":e}):t}function findClickableElement(t){if(!t.tagName)return null;var e=t.tagName.toLowerCase(),n=t.type;return t.hasAttribute("onclick")||t.hasAttribute("href")||"button"==e||"input"==e&&("submit"==n||"button"==n||"image"==n||"radio"==n||"checkbox"==n||"reset"==n)?t:null==t.parentNode?null:findClickableElement(t.parentNode)}addListeners("select","focus",function(e){if(e.target.nodeName){var t=e.target.nodeName.toLowerCase();if("select"==t&&e.target.multiple)for(var n=e.target.options,a=0;a<n.length;a++)null==n[a]._wasSelected&&(n[a]._wasSelected=n[a].selected)}},!0),addListeners("select","change",function(e){if(e.target.tagName){var t=e.target.tagName.toLowerCase();if("select"==t)if(prevTargetElement=e.target,!e.target.multiple){var n=e.target.options[e.target.selectedIndex];record("select",e.target,getOptionLocator(n))}else for(var a=e.target.options,d=0;d<a.length;d++)if(null==a[d]._wasSelected,a[d]._wasSelected!=a[d].selected){var s=getOptionLocator(a[d]);a[d].selected?record("addSelection",e.target,s,!0):record("removeSelection",e.target,s,!0),a[d]._wasSelected=a[d].selected}}});function getText(e){var t="",n=browserVersion.isFirefox&&"1.5"<=browserVersion.firefoxVersion;return n||browserVersion.isKonqueror||browserVersion.isSafari||browserVersion.isOpera?t=getTextContent(e):e.textContent?t=e.textContent:e.innerText&&(t=e.innerText),t=normalizeNewlines(t),t=normalizeSpaces(t),t.trim()}function getTextContent(e,t){if(e.style&&("hidden"==e.style.visibility||"none"==e.style.display))return"";if(3==e.nodeType){var n=e.data;return t||(n=n.replace(/\n|\r|\t/g," ")),n}if(1==e.nodeType&&"SCRIPT"!=e.nodeName){for(var a,d=t||"PRE"==e.tagName,n="",s=0;s<e.childNodes.length;s++)a=e.childNodes.item(s),n+=getTextContent(a,d);return("P"==e.tagName||"BR"==e.tagName||"HR"==e.tagName||"DIV"==e.tagName)&&(n+="\n"),n}return""}function normalizeNewlines(e){return e.replace(/\r\n|\r/g,"\n")}function normalizeSpaces(e){var t=String.fromCharCode;if(browserVersion.isIE)return e;e=e.replace(/\ +/g," ");var n=/Â /g;return browserVersion.isSafari?replaceAll(e,t(160)," "):e.replace(n," ")}